local MatexLib = {}

function MatexLib:CreateWindow(title)
    -- Services & player
    local plr = game.Players.LocalPlayer
    local char = plr.Character or plr.CharacterAdded:Wait()

    -- GUI setup
    local MatexUI = Instance.new("ScreenGui")
    MatexUI.ResetOnSpawn = false
    MatexUI.IgnoreGuiInset = true
    MatexUI.Name = "MatexUI"
    MatexUI.Parent = plr:WaitForChild("PlayerGui")

    local MatexFrame = Instance.new("Frame")
    MatexFrame.Name = "MatexFrame"
    MatexFrame.Size = UDim2.new(0, 350, 0, 240)
    MatexFrame.Position = UDim2.new(0, 150, 0, 100)
    MatexFrame.BackgroundColor3 = Color3.fromRGB(64, 64, 64)
    MatexFrame.BorderSizePixel = 2
    MatexFrame.Draggable = true
    MatexFrame.Active = true
    MatexFrame.Parent = MatexUI
    Instance.new("UICorner", MatexFrame).CornerRadius = UDim.new(0, 2)

local NotifHolder = Instance.new("Frame", MatexFrame)
NotifHolder.Name = "NotifHolder"
NotifHolder.Size = UDim2.new(1, -10, 0, 100)
NotifHolder.Position = UDim2.new(0, 5, 1, -105)
NotifHolder.BackgroundTransparency = 1
NotifHolder.ZIndex = 10
NotifHolder.ClipsDescendants = true

local notifLayout = Instance.new("UIListLayout", NotifHolder)
notifLayout.SortOrder = Enum.SortOrder.LayoutOrder
notifLayout.Padding = UDim.new(0, 5)

    local HubLabel = Instance.new("TextLabel", MatexFrame)
    HubLabel.Size = UDim2.new(0, 100, 0, 20)
    HubLabel.Position = UDim2.new(0, 5, 0, 0)
    HubLabel.BackgroundTransparency = 1
    HubLabel.TextColor3 = Color3.new(1, 1, 1)
    HubLabel.TextStrokeColor3 = Color3.fromRGB(0, 127, 0)
    HubLabel.TextScaled = true
    HubLabel.Text = title or "Matex Hub"

    local X = Instance.new("TextButton", MatexFrame)
    X.Size = UDim2.new(0, 20, 0, 20)
    X.Position = UDim2.new(0, 329, 0, 1)
    X.BackgroundColor3 = Color3.fromRGB(162, 162, 162)
    X.BackgroundTransparency = 0.899
    X.TextColor3 = Color3.fromRGB(255, 0, 0)
    X.TextScaled = true
    X.Text = "X"
    Instance.new("UICorner", X)

    X.MouseButton1Click:Connect(function()
        MatexUI:Destroy()
    end)

    local ScrollFrame = Instance.new("ScrollingFrame", MatexFrame)
    ScrollFrame.Name = "ScrollFrame"
    ScrollFrame.Position = UDim2.new(0, 5, 0, 20)
    ScrollFrame.Size = UDim2.new(0, 100, 0, 170)
    ScrollFrame.BackgroundColor3 = Color3.fromRGB(162, 162, 162)
    ScrollFrame.BorderSizePixel = 2
    ScrollFrame.ScrollBarThickness = 4
    ScrollFrame.AutomaticCanvasSize = Enum.AutomaticSize.Y
    ScrollFrame.CanvasSize = UDim2.new(0, 0, 0, 0)
    ScrollFrame.ClipsDescendants = true

    local layout = Instance.new("UIListLayout", ScrollFrame)
    layout.SortOrder = Enum.SortOrder.LayoutOrder
    layout.Padding = UDim.new(0, 5)

    local tabContent = Instance.new("ScrollingFrame")
tabContent.Name = name .. "_Content"
tabContent.Parent = ContentFrame
tabContent.BackgroundTransparency = 1
tabContent.Size = UDim2.new(1, 0, 1, 0)
tabContent.Visible = false
tabContent.ScrollBarThickness = 4
tabContent.AutomaticCanvasSize = Enum.AutomaticSize.Y
tabContent.CanvasSize = UDim2.new(0, 0, 0, 0)
tabContent.ClipsDescendants = true

    -- Player image
    local userId = plr.UserId
    local content = game.Players:GetUserThumbnailAsync(userId, Enum.ThumbnailType.HeadShot, Enum.ThumbnailSize.Size100x100)
    local avatarImage = Instance.new("ImageLabel", MatexFrame)
    avatarImage.Name = "PlayerImage"
    avatarImage.Size = UDim2.new(0, 35, 0, 35)
    avatarImage.Position = UDim2.new(0, 5, 1, -40)
    avatarImage.Image = content
    avatarImage.BackgroundColor3 = Color3.new(1, 1, 1)
    avatarImage.BorderSizePixel = 1
    avatarImage.ScaleType = Enum.ScaleType.Fit
    Instance.new("UICorner", avatarImage).CornerRadius = UDim.new(1, 0)

    
-- Player name label (beside avatar image)
local nameLabel = Instance.new("TextLabel", MatexFrame)
nameLabel.Name = "PlayerName"
nameLabel.Size = UDim2.new(0, 100, 0, 35)
nameLabel.Position = UDim2.new(0, 45, 1, -35) -- right of avatar
nameLabel.BackgroundTransparency = 1
nameLabel.TextColor3 = Color3.new(1, 1, 1)
nameLabel.TextScaled = true
nameLabel.Font = Enum.Font.SourceSansBold
nameLabel.TextXAlignment = Enum.TextXAlignment.Left
nameLabel.Text = plr.Name

    -- Return tab creator
    local window = {}

function window:Notify(text, duration)
    duration = duration or 3

    local notif = Instance.new("TextLabel", NotifHolder)
    notif.Size = UDim2.new(1, 0, 0, 25)
    notif.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
    notif.TextColor3 = Color3.new(1, 1, 1)
    notif.TextScaled = true
    notif.Font = Enum.Font.SourceSansBold
    notif.Text = text
    notif.ZIndex = 11
    notif.BorderSizePixel = 0

    local corner = Instance.new("UICorner", notif)
    corner.CornerRadius = UDim.new(0, 4)

    task.delay(duration, function()
        if notif then
            notif:Destroy()
        end
    end)
end

    function window:CreateTab(name)
        local tabBtn = Instance.new("TextButton", ScrollFrame)
        tabBtn.Size = UDim2.new(1, 0, 0, 30)
        tabBtn.Text = name
        tabBtn.BackgroundColor3 = Color3.fromRGB(200, 200, 200)
        tabBtn.TextColor3 = Color3.new(1, 1, 1)
        tabBtn.BorderSizePixel = 0
        tabBtn.Name = name

        local tabContent = Instance.new("Frame")
        tabContent.Name = name .. "_Content"
        tabContent.Parent = ContentFrame
        tabContent.BackgroundTransparency = 1
        tabContent.Size = UDim2.new(1, 0, 1, 0)
        tabContent.Visible = false

        local contentLayout = Instance.new("UIListLayout", tabContent)
        contentLayout.SortOrder = Enum.SortOrder.LayoutOrder
        contentLayout.Padding = UDim.new(0, 5)

        tabBtn.MouseButton1Click:Connect(function()
            for _, t in pairs(ContentFrame:GetChildren()) do
                if t:IsA("Frame") then t.Visible = false end
            end
            tabContent.Visible = true
        end)

        local tab = {}

function tab:CreateDropdown(options, callback)
    local dropdownHolder = Instance.new("Frame", tabContent)
    dropdownHolder.Size = UDim2.new(1, 0, 0, 30 + (#options * 25))
    dropdownHolder.BackgroundTransparency = 1

    local dropdownButton = Instance.new("TextButton", dropdownHolder)
    dropdownButton.Size = UDim2.new(1, 0, 0, 30)
    dropdownButton.Text = "Select an option"
    dropdownButton.BackgroundColor3 = Color3.fromRGB(64, 64, 64)
    dropdownButton.TextColor3 = Color3.new(1, 1, 1)
    dropdownButton.BorderSizePixel = 0
    Instance.new("UICorner", dropdownButton).CornerRadius = UDim.new(0, 4)

    local listLayout = Instance.new("UIListLayout", dropdownHolder)
    listLayout.SortOrder = Enum.SortOrder.LayoutOrder
    listLayout.Padding = UDim.new(0, 5)

    for _, option in ipairs(options) do
        local item = Instance.new("TextButton", dropdownHolder)
        item.Size = UDim2.new(1, 0, 0, 25)
        item.Text = option
        item.BackgroundColor3 = Color3.fromRGB(90, 90, 90)
        item.TextColor3 = Color3.new(1, 1, 1)
        item.Visible = false
        item.BorderSizePixel = 0
        Instance.new("UICorner", item).CornerRadius = UDim.new(0, 4)

        item.MouseButton1Click:Connect(function()
            dropdownButton.Text = option
            for _, child in ipairs(dropdownHolder:GetChildren()) do
                if child:IsA("TextButton") and child ~= dropdownButton then
                    child.Visible = false
                end
            end
            pcall(callback, option)
        end)
    end

    local isOpen = false
    dropdownButton.MouseButton1Click:Connect(function()
        isOpen = not isOpen
        for _, child in ipairs(dropdownHolder:GetChildren()) do
            if child:IsA("TextButton") and child ~= dropdownButton then
                child.Visible = isOpen
            end
        end
    end)
end

function tab:CreateSlider(label, min, max, default, callback)
    min = min or 1
    max = max or 500
    default = math.clamp(default or min, min, max)

    local holder = Instance.new("Frame", tabContent)
    holder.Size = UDim2.new(1, 0, 0, 25)
    holder.BackgroundTransparency = 1

    local labelBox = Instance.new("TextLabel", holder)
    labelBox.Size = UDim2.new(0.6, 0, 1, 0)
    labelBox.Position = UDim2.new(0, 0, 0, 0)
    labelBox.BackgroundTransparency = 1
    labelBox.Text = label .. ": " .. default
    labelBox.TextColor3 = Color3.new(1, 1, 1)
    labelBox.Font = Enum.Font.SourceSansBold
    labelBox.TextScaled = true
    labelBox.TextXAlignment = Enum.TextXAlignment.Left

    local input = Instance.new("TextBox", holder)
    input.Size = UDim2.new(0.4, -5, 1, 0)
    input.Position = UDim2.new(0.6, 5, 0, 0)
    input.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
    input.TextColor3 = Color3.new(1, 1, 1)
    input.Text = tostring(default)
    input.TextScaled = true
    input.Font = Enum.Font.SourceSans
    input.BorderSizePixel = 0
    input.ClearTextOnFocus = false
    Instance.new("UICorner", input).CornerRadius = UDim.new(0, 4)

    input.FocusLost:Connect(function(enterPressed)
        if enterPressed then
            local val = tonumber(input.Text)
            if val then
                val = math.clamp(math.floor(val), min, max)
                input.Text = tostring(val)
                labelBox.Text = label .. ": " .. val
                if callback then
                    pcall(callback, val)
                end
            else
                input.Text = tostring(default)
            end
        end
    end)
end

        function tab:CreateToggle(text, default, callback)
    local toggle = Instance.new("TextButton", tabContent)
    toggle.Size = UDim2.new(1, 0, 0, 25)
    toggle.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
    toggle.TextColor3 = Color3.new(1, 1, 1)
    toggle.TextScaled = true
    toggle.Font = Enum.Font.SourceSansBold
    toggle.BorderSizePixel = 0
    toggle.AutoButtonColor = false
    Instance.new("UICorner", toggle).CornerRadius = UDim.new(0, 4)

    local state = default or false

    local function update()
        if state then
            toggle.Text = "âœ“ " .. text
            toggle.BackgroundColor3 = Color3.fromRGB(0, 170, 0)
        else
            toggle.Text = "O " .. text
            toggle.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
        end
    end

    update()

    toggle.MouseButton1Click:Connect(function()
        state = not state
        update()
        if callback then
            pcall(callback, state)
        end
    end)
end

        function tab:CreateSection(title)
    local section = Instance.new("TextLabel", tabContent)
    section.Size = UDim2.new(1, 0, 0, 20)
    section.BackgroundTransparency = 1
    section.Text = "  " .. title
    section.TextColor3 = Color3.new(1, 1, 1)
    section.Font = Enum.Font.SourceSansBold
    section.TextXAlignment = Enum.TextXAlignment.Left
    section.TextScaled = true
end

        function tab:CreateButton(text, callback)
            local btn = Instance.new("TextButton", tabContent)
Instance.new("UICorner", btn).CornerRadius = UDim.new(0, 4)
            btn.Size = UDim2.new(1, 0, 0, 20)
            btn.Position = UDim2.new(0.5, 0, 0)
            btn.Text = text
            btn.BackgroundColor3 = Color3.fromRGB(64, 64, 64)
            btn.TextColor3 = Color3.new(255, 255, 255)
            btn.BorderSizePixel = 0
            btn.MouseButton1Click:Connect(function()
                pcall(callback)
            end)
        end

        function tab:CreateInput(placeholderText, callback)
    local inputBox = Instance.new("TextBox", tabContent)
    inputBox.Size = UDim2.new(1, 0, 0, 25)
    inputBox.PlaceholderText = placeholderText or "Enter text..."
    inputBox.Text = ""
    inputBox.TextColor3 = Color3.new(1, 1, 1)
    inputBox.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
    inputBox.BorderSizePixel = 0
    inputBox.TextScaled = true
    inputBox.Font = Enum.Font.SourceSans
    inputBox.TextXAlignment = Enum.TextXAlignment.Left
    Instance.new("UICorner", inputBox).CornerRadius = UDim.new(0, 4)

    inputBox.FocusLost:Connect(function(enterPressed)
        if enterPressed then
            pcall(function()
                callback(inputBox.Text)
            end)
        end
    end)
end

        return tab
    end

    return window
end

return MatexLib
