-- Services
local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local Player = Players.LocalPlayer

-- Load Rayfield UI Library
local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()

-- Create Main Window
local Window = Rayfield:CreateWindow({
    Name = "Eclipse UI",
    LoadingTitle = "Welcome to the Void",
    LoadingSubtitle = "by Delight",
    ConfigurationSaving = {
        Enabled = true,
        FolderName = "EclipseConfigs",
        FileName = "EclipseSettings"
    },
    KeySystem = true,
    KeySettings = {
        Title = "A Nightmare",
        Subtitle = "Key System",
        Note = "I gotch ya its Enlighten.",
        FileName = "Key",
        SaveKey = true,
        GrabKeyFromSite = false,
        Key = {"Enlighten", "DeEnlighten"}
    }
})

-- Tabs
local PlayerTab = Window:CreateTab("Player", 4483362458)
local GameTab = Window:CreateTab("Games", 4483362458)
local OtherTab = Window:CreateTab("Other", 4483362458)
local SettingsTab = Window:CreateTab("Settings", 4483362458)

-- Destroy UI
SettingsTab:CreateKeybind({
    Name = "Destroy UI",
    CurrentKeybind = "Q",
    Callback = function()
        Rayfield:Destroy()
    end,
})

-- Infinite Yield
OtherTab:CreateButton({
    Name = "Infinite Yield",
    Callback = function()
        loadstring(game:HttpGet("https://raw.githubusercontent.com/edgey77/infiniteyield/master/source"))()
    end,
})

-- Blox Fruits (Redz Hub)
GameTab:CreateButton({
    Name = "Blox Fruits (Redz Hub)",
    Callback = function()
        loadstring(game:HttpGet("https://raw.githubusercontent.com/newredz/BloxFruits/main/Source.luau"))()
    end,
})

-- Tower of Hell
GameTab:CreateButton({
    Name = "Tower of Hell Script",
    Callback = function()
        if game.PlaceId == 1962086868 then
            loadstring(game:HttpGet("https://raw.githubusercontent.com/jensonhirst/Orion/main/ToH.lua"))()
        else
            Rayfield:Notify({
                Title = "Wrong Game",
                Content = "Teleport to Tower of Hell to use this script.",
                Duration = 5,
            })
        end
    end,
})

-- Auto Hoops
GameTab:CreateToggle({
    Name = "Legends of Speed Auto Hoops",
    CurrentValue = false,
    Flag = "AutoHoopsToggle1",
    Callback = function(Value)
        _G.Auto = Value
        task.spawn(function()
            while _G.Auto do
                local rootPart = Player.Character and Player.Character:FindFirstChild("HumanoidRootPart")
                if rootPart then
                    for _, v in ipairs(workspace.Hoops:GetChildren()) do
                        rootPart.CFrame = v.CFrame
                        task.wait(0.2)
                    end
                end
                task.wait(0.5)
            end
        end)
    end,
})

-- Teleport to Player
PlayerTab:CreateInput({
    Name = "Teleport to player",
    CurrentValue = "",
    PlaceholderText = "Put the player name to teleport",
    RemoveTextAfterFocusLost = false,
    Flag = "Input1",
    Callback = function(Text)
        local TargetPlayer = Players:FindFirstChild(Text)
        if TargetPlayer and TargetPlayer.Character and TargetPlayer.Character:FindFirstChild("HumanoidRootPart") then
            local myRoot = Player.Character and Player.Character:FindFirstChild("HumanoidRootPart")
            if myRoot then
                myRoot.CFrame = TargetPlayer.Character.HumanoidRootPart.CFrame
            end
        else
            warn("Target player or their character not found.")
        end
    end,
})

-- WalkSpeed
PlayerTab:CreateSlider({
    Name = "WalkSpeed",
    Range = {16, 200},
    Increment = 1,
    Suffix = "Speed",
    CurrentValue = 16,
    Callback = function(Value)
        local humanoid = Player.Character and Player.Character:FindFirstChildOfClass("Humanoid")
        if humanoid then
            humanoid.WalkSpeed = Value
        end
    end,
})

-- JumpPower
PlayerTab:CreateSlider({
    Name = "JumpPower",
    Range = {50, 200},
    Increment = 1,
    CurrentValue = 50,
    Callback = function(Value)
        local humanoid = Player.Character and Player.Character:FindFirstChildOfClass("Humanoid")
        if humanoid then
            humanoid.JumpPower = Value
        end
    end,
})

-- Infinite Jump
local infiniteJumpEnabled = false
PlayerTab:CreateToggle({
    Name = "Infinite Jump",
    CurrentValue = false,
    Callback = function(Value)
        infiniteJumpEnabled = Value
    end,
})

UserInputService.JumpRequest:Connect(function()
    if infiniteJumpEnabled then
        local humanoid = Player.Character and Player.Character:FindFirstChildOfClass("Humanoid")
        if humanoid then
            humanoid:ChangeState(Enum.HumanoidStateType.Jumping)
        end
    end
end)

-- Noclip
local noclipEnabled = false
PlayerTab:CreateToggle({
    Name = "Noclip",
    CurrentValue = false,
    Callback = function(Value)
        noclipEnabled = Value
        task.spawn(function()
            while noclipEnabled do
                local character = Player.Character
                if character then
                    for _, part in ipairs(character:GetDescendants()) do
                        if part:IsA("BasePart") then
                            part.CanCollide = false
                        end
                    end
                end
                task.wait()
            end
        end)
    end,
})

-- ESP
local espEnabled = false
local espFolder = Instance.new("Folder", game.CoreGui)
espFolder.Name = "ESP"

local function createHighlight(player)
    if player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
        if not espFolder:FindFirstChild(player.Name) then
            local highlight = Instance.new("Highlight")
            highlight.Name = player.Name
            highlight.Adornee = player.Character
            highlight.FillColor = Color3.fromRGB(128, 0, 128)
            highlight.OutlineColor = Color3.fromRGB(255, 255, 255)
            highlight.FillTransparency = 0.5
            highlight.Parent = espFolder
        end
    end
end

local function removeHighlight(player)
    local highlight = espFolder:FindFirstChild(player.Name)
    if highlight then
        highlight:Destroy()
    end
end

Players.PlayerRemoving:Connect(removeHighlight)
Players.PlayerAdded:Connect(function(player)
    player.CharacterAdded:Connect(function()
        if espEnabled then
            task.wait(1)
            createHighlight(player)
        end
    end)
end)

task.spawn(function()
    while true do
        if espEnabled then
            for _, player in ipairs(Players:GetPlayers()) do
                if player ~= Player then
                    createHighlight(player)
                end
            end
        else
            for _, obj in ipairs(espFolder:GetChildren()) do
                obj:Destroy()
            end
        end
        task.wait(1)
    end
end)

PlayerTab:CreateToggle({
    Name = "Player ESP (Purple)",
    CurrentValue = false,
    Callback = function(Value)
        espEnabled = Value
    end,
})
